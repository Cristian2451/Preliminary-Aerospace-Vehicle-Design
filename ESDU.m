clear
clc

hb_2 = [0.099815157, 0.138632163, 0.245841035, 0.282809612, 0.336414048, 0.401109057, 0.467652495, 0.528650647, 0.617375231, 0.68207024, 0.759704251, 0.870609982, 0.913123845, 0.970425139, 1];
K_2 = [6.068393782, 6.015716753, 5.899827288, 5.868221071, 5.836614853, 5.815544041, 5.805008636, 5.805008636, 5.79447323, 5.783937824, 5.773402418, 5.752331606, 5.752331606, 5.7417962, 5.731260794];

hb_1_5 = [0.099815157, 0.144177449, 0.199630314, 0.242144177, 0.308687616, 0.360443623, 0.410351201, 0.465804067, 0.517560074, 0.597042514, 0.68207024, 0.774491682, 0.84103512, 0.892791128, 0.95194085, 0.998151571];
K_1_5 = [5.963039724, 5.868221071, 5.762867012, 5.689119171, 5.61537133, 5.562694301, 5.531088083, 5.488946459, 5.457340242, 5.43626943, 5.394127807, 5.362521589, 5.341450777, 5.320379965, 5.30984456, 5.30984456];

hb_1_25 = [0.101663586, 0.123844732, 0.153419593, 0.179297597, 0.212569316, 0.243992606, 0.282809612, 0.356746765, 0.395563771, 0.441774492, 0.495378928, 0.547134935, 0.6025878, 0.632162662, 0.674676525, 0.731977819, 0.770794824, 0.80961183, 0.85767098, 0.892791128, 0.931608133, 0.972273567, 0.998151571];
K_1_25 = [5.783937824, 5.699654577, 5.604835924, 5.520552677, 5.43626943, 5.362521589, 5.299309154, 5.204490501, 5.172884283, 5.141278066, 5.120207254, 5.099136442, 5.07806563, 5.07806563, 5.056994819, 5.025388601, 4.993782383, 4.962176166, 4.920034542, 4.877892919, 4.846286701, 4.793609672, 4.751468048];

hb_1 = [0.101663586, 0.12754159, 0.153419593, 0.22181146, 0.273567468, 0.336414048, 0.410351201, 0.46025878, 0.547134935, 0.600739372, 0.641404806, 0.689463956, 0.748613678, 0.802218115, 0.859519409, 0.896487985, 0.926062847, 0.959334566, 1];
K_1 = [5.488946459, 5.383592401, 5.278238342, 5.056994819, 4.920034542, 4.814680484, 4.709326425, 4.677720207, 4.603972366, 4.561830743, 4.519689119, 4.46701209, 4.393264249, 4.308981002, 4.214162349, 4.129879102, 4.066666667, 3.961312608, 3.813816926];

hb_0_9 = [0.101663586, 0.133086876, 0.168207024, 0.22181146, 0.266173752, 0.33271719, 0.391866913, 0.465804067, 0.519408503, 0.573012939, 0.639556377, 0.709796673, 0.754158965, 0.79297597, 0.826247689, 0.881700555, 0.907578558, 0.946395564, 0.998151571];
K_0_9 = [5.278238342, 5.120207254, 4.972711572, 4.804145078, 4.688255613, 4.551295337, 4.477547496, 4.435405872, 4.393264249, 4.351122625, 4.28791019, 4.203626943, 4.129879102, 4.066666667, 3.992918826, 3.834887737, 3.750604491, 3.603108808, 3.392400691];

hb_0_8 = [0.099815157, 0.138632163, 0.179297597, 0.227356747, 0.280961183, 0.334565619, 0.371534196, 0.41219963, 0.456561922, 0.528650647, 0.593345656, 0.628465804, 0.665434381, 0.715341959, 0.767097967, 0.813308688, 0.853974122, 0.88909427, 0.929759704, 0.957486137, 0.998151571];
K_0_8 = [4.993782383, 4.835751295, 4.688255613, 4.551295337, 4.435405872, 4.351122625, 4.308981002, 4.266839378, 4.235233161, 4.172020725, 4.10880829, 4.056131261, 4.003454231, 3.92970639, 3.834887737, 3.708462867, 3.582037997, 3.413471503, 3.223834197, 3.086873921, 2.897236615];

hb_0_7 = [0.099815157, 0.133086876, 0.171903882, 0.216266174, 0.260628466, 0.312384473, 0.360443623, 0.423290203, 0.471349353, 0.530499076, 0.580406654, 0.626617375, 0.669131238, 0.709796673, 0.741219963, 0.768946396, 0.791127542, 0.826247689, 0.853974122, 0.924214418, 0.970425139, 1];
K_0_7 = [4.688255613, 4.572366149, 4.445941278, 4.340587219, 4.245768566, 4.172020725, 4.119343696, 4.066666667, 4.024525043, 3.971848014, 3.92970639, 3.866493955, 3.80328152, 3.718998273, 3.613644214, 3.508290155, 3.413471503, 3.244905009, 3.065803109, 2.665457686, 2.423143351, 2.29671848];

hb_0_6 = [0.099815157, 0.14232902, 0.20702403, 0.260628466, 0.340110906, 0.438077634, 0.506469501, 0.569316081, 0.635859519, 0.680221811, 0.719038817, 0.743068392, 0.772643253, 0.800369686, 0.839186691, 0.883548983, 0.926062847, 0.974121996, 1];
K_0_6 = [4.41433506, 4.256303972, 4.10880829, 4.045595855, 3.98238342, 3.898100173, 3.845423143, 3.771675302, 3.655785838, 3.529360967, 3.31865285, 3.150086356, 2.907772021, 2.707599309, 2.433678756, 2.17029361, 1.959585492, 1.769948187, 1.68566494];

hb_0_5 = [0.099815157, 0.134935305, 0.171903882, 0.208872458, 0.258780037, 0.323475046, 0.384473198, 0.467652495, 0.537892791, 0.558225508, 0.569316081, 0.589648799, 0.609981516, 0.630314233, 0.654343808, 0.676524954, 0.704251386, 0.731977819, 0.763401109, 0.789279113, 0.831792976, 0.870609982, 0.918669131, 0.972273567, 0.998151571];
K_0_5 = [4.150949914, 4.056131261, 3.98238342, 3.940241796, 3.898100173, 3.855958549, 3.80328152, 3.740069085, 3.666321244, 3.645250432, 3.529360967, 3.360794473, 3.181692573, 3.013126079, 2.823488774, 2.65492228, 2.454749568, 2.275647668, 2.107081174, 1.959585492, 1.769948187, 1.611917098, 1.443350604, 1.306390328, 1.232642487];

% figure
% plot(hb_2,K_2)
% hold on
% plot(hb_1_5,K_1_5)
% plot(hb_1,K_1)
% plot(hb_0_9,K_0_9)
% plot(hb_0_8,K_0_8)
% plot(hb_0_7,K_0_7)
% plot(hb_0_6,K_0_6)
% plot(hb_0_5,K_0_5)
% hold off
% xlabel('h/b')
% ylabel('K')
% legend('2','1.5','1','0.9','0.8','0.7','0.6','0.5')

[xData1, yData1] = prepareCurveData(hb_2, K_2);
f2 = fit(xData1, yData1,'pchip');

[xData2, yData2] = prepareCurveData(hb_1_5, K_1_5);
f1_5 = fit(xData2, yData2,'pchip');

[xData3, yData3] = prepareCurveData(hb_1_25, K_1_25);
f1_25 = fit(xData3, yData3,'pchip');

[xData4, yData4] = prepareCurveData(hb_1, K_1);
f1 = fit(xData4, yData4,'pchip');

[xData5, yData5] = prepareCurveData(hb_0_9, K_0_9);
f0_9 = fit(xData5, yData5,'pchip');

[xData6, yData6] = prepareCurveData(hb_0_8, K_0_8);
f0_8 = fit(xData6, yData6,'pchip');

[xData7, yData7] = prepareCurveData(hb_0_7, K_0_7);
f0_7 = fit(xData7, yData7,'pchip');

[xData8, yData8] = prepareCurveData(hb_0_6, K_0_6);
f0_6 = fit(xData8, yData8,'pchip');

[xData9, yData9] = prepareCurveData(hb_0_5, K_0_5);
f0_5 = fit(xData9, yData9,'pchip');

x = linspace(0.1,1,100);

figure
plot(x,f2(x),'b-','LineWidth',1.5)
hold on
plot(x,f1_5(x),'r-','LineWidth',1.5)
plot(x,f1_25(x),'g-','LineWidth',1.5)
plot(x,f1(x),'m-','LineWidth',1.5)
plot(x,f0_9(x),'c-','LineWidth',1.5)
plot(x,f0_8(x),'Color',[0.75, 0.75, 0],'LineWidth',1.5)
plot(x,f0_7(x),'LineWidth',1.5)
plot(x,f0_6(x),'LineWidth',1.5)
plot(x,f0_5(x),'color',[0, 0.40, 0],'LineWidth',1.5)
yline(3.62,'k--','LineWidth',1.5)
hold off
grid on
box on
ax=gca;ax.LineWidth=1;
set(gca,'FontSize',15)
set(gca,'TickLabelInterpreter','latex')
xlabel('h/b','Interpreter', 'latex', 'FontSize',18)
ylabel('K','Interpreter', 'latex', 'FontSize',18)
legend('$t_s/t = 2$','$t_s/t = 1.5$','$t_s/t = 1.25$','$t_s/t = 1$','$t_s/t = 0.9$','$t_s/t = 0.8$','$t_s/t = 0.7$','$t_s/t = 0.6$','$t_s/t = 0.5$','Interpreter', 'latex', 'FontSize',16)



